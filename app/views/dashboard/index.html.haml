%div{ class: "max-w-6xl mx-auto px-6 py-10 text-stone-900" }

  %h1{ class: "text-3xl font-semibold mb-6" } Draft Board

  %div{ class: "border border-stone-300 p-6 mb-10 bg-stone-50" }
    %h2{ class: "text-lg font-semibold mb-4" } Remaining Needs

    %div{ class: "grid grid-cols-2 md:grid-cols-4 gap-6 text-sm" }

      %div
        %p.text-stone-600 Pitchers Needed
        %p.text-xl.font-semibold= @team.pitchers_needed

      %div
        %p.text-stone-600 Catchers Needed
        %p.text-xl.font-semibold= @team.catchers_needed

      %div
        %p.text-stone-600 Middle Infield Needed
        %p.text-xl.font-semibold= @team.middle_infield_needed

      %div
        %p.text-stone-600 Bench Spots Left
        %p.text-xl.font-semibold= @team.spots_remaining


  %div{ class: "mb-8 text-sm" }
    Pitchers: #{@team.pitchers_count} |
    Catchers: #{@team.catchers_count} |
    Middle Infield: #{@team.middle_infield_count}

  - best = @ranked_players.first

  - if best
    %div{ class: "border-2 border-green-600 p-6 mb-12" }
      %p.text-sm.text-stone-600 Recommended Pick
      %h2.text-2xl.font-semibold.mb-3= best.name
      %p.mb-1
        %span{ class: tier_badge_class(best.tier) }
          Tier: #{best.tier}
      %p.mb-2 Positions: #{best.positions.map(&:name).join(", ")}
      %p.mb-2
        Recommendation Score: #{ best.recommendation_score( @team, dropoffs: @dropoffs, depths: @position_depths, top_by_position: @top_by_position, total_teams: Team.count)}
        - if best.evaluation_stale?
          %p.text-yellow-600.text-sm.mb-1 Data is stale
        - elsif best.confidence_level && best.confidence_level <= 2
          %p.text-red-600.text-sm.mb-1 Low confidence evaluation

      %p.mb-4 Overall Score: #{best.overall_score}
      - if best.manual_adjustment
        %p.mb-4 (Manual Adjustment: #{best.manual_adjustment})
      = button_to "Draft #{best.name}", draft_player_path(best, team_id: @team.id), method: :post, class: "border border-stone-900 px-4 py-2 hover:bg-stone-900 hover:text-white"

  %h2{ class: "text-xl font-semibold mb-4" } Full Ranked Board

  %table{ class: "w-full text-sm border-collapse" }
    %thead
      %tr{ class: "border-b border-stone-300 text-left" }
        %th.py-3 Rank
        %th.py-3 Name
        %th.py-3 Age
        %th.py-3 Positions
        %th.py-3.text-center Rec
        %th.py-3.text-center Overall
        %th.py-3.text-center Adjusted
        %th.py-3.text-center Data
        %th.py-3.text-center Tier

    %tbody
      - @ranked_players.each_with_index do |player, index|
        %tr{ class: "border-b border-stone-200 hover:bg-stone-50" }
          %td.py-5= index + 1
          %td.py-5= link_to player.name, player_path(player), class: "underline"
          %td.py-5= player.age
          %td.py-5= player.positions.pluck(:name).join(", ")
          %td.py-5.text-center= player.recommendation_score( @team, dropoffs: @dropoffs, depths: @position_depths, top_by_position: @top_by_position, total_teams: Team.count)
          %td.py-5.text-center= player.overall_score
          %td.py-5.text-center= player.manual_adjustment ? "(#{player.manual_adjustment})" : '-'
          %td.py-5.text-center.flex.flex-col.gap-2
            - if player.evaluation_stale?
              %span.text-yellow-600.text-xs STALE
            - if player.confidence_level && player.confidence_level <= 2
              %span.text-red-600.text-xs LOW DATA
          %td.text-center.py-5
            %span{ class: tier_badge_class(player.tier) }
              = player.tier
          %td.py-5.flex.gap-2.items-center
            = button_to "Draft", draft_player_path(player, team_id: @team.id), method: :post, class: "border border-stone-900 px-3 py-1 hover:bg-stone-900 hover:text-white"
            = link_to "Assignâ€¦", assign_player_path(player), class: "underline text-sm"

