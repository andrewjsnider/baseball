%div{ class: "max-w-6xl mx-auto px-6 py-10 text-stone-900" }

  %div{ class: "flex justify-between items-center mb-8" }
    %h1{ class: "text-3xl font-semibold" } Players
    %div{ class: "flex gap-3 items-center" }
      = link_to "New Player", new_player_path, class: "border border-stone-900 px-4 py-2 hover:bg-stone-900 hover:text-white"
      = link_to "Import from CSV", import_players_path, class: "underline"
      = link_to "Player Evals", evals_players_path, class: "underline"

  %table{ class: "w-full text-sm border-collapse" }
    %thead
      %tr{ class: "border-b border-stone-300 text-left" }
        %th.py-3 PCR ID
        %th.py-3 Name
        %th.py-3 Age
        %th.py-3 Source
        %th.py-3 Positions
        %th.py-3 Overall
        %th.py-3 Tier
        %th.py-3
    %tbody
      - @players.each do |player|
        :ruby
          source =  if player.uses_ratings_card?
                      "Eval"
                    elsif player.uses_pcr_sheet?
                      "PCR"
                    else
                      "Legacy"
                    end

        %tr{ class: "border-b border-stone-200 hover:bg-stone-50" }
          %td.py-4= player.pcr_id.presence || "-"
          %td.py-4= link_to player.name, player_path(player), class: "underline"
          %td.py-4= (player.age.presence || player.age_from_pcr_id || "-")
          %td.py-4= source
          %td.py-4= player.positions.pluck(:name).join(", ").presence || "-"
          %td.py-4= player.overall_score
          %td.py-4
            - display_tier = player.tier.presence || player.computed_tier
            - if display_tier.present?
              %span{ class: tier_badge_class(display_tier) }= display_tier
            - else
              %span -
          %td.py-4
            %div{ class: "flex gap-3" }
              = link_to "Edit", edit_player_path(player), class: "underline"
              = link_to "Delete", player_path(player), method: :delete, data: { confirm: "Are you sure?" }, class: "underline text-red-600"